#
# A very simple test to check on basic register-flow control
# and pipeline flushing.
#
= asm

	add r3,r1,r2
	add r4,r1,r1
	add r5,r2,r2
	add r1,r1,r1
	add r1,r1,r1
	mtlr r3      # will flush the pipe.
	add r1,r1,r1
	add r1,r1,r1
	
= /asm

CORE n=:P

# <GEN>
MD n=Mem ra=0x00000000 d=0x7C611214	#	add r3,r1,r2
MD n=Mem ra=0x00000004 d=0x7C810A14	#	add r4,r1,r1
MD n=Mem ra=0x00000008 d=0x7CA21214	#	add r5,r2,r2
MD n=Mem ra=0x0000000c d=0x7C210A14	#	add r1,r1,r1
MD n=Mem ra=0x00000010 d=0x7C210A14	#	add r1,r1,r1
MD n=Mem ra=0x00000014 d=0x7C6803A6	#	mtlr r3
MD n=Mem ra=0x00000018 d=0x7C210A14	#	add r1,r1,r1
MD n=Mem ra=0x0000001c d=0x7C210A14	#	add r1,r1,r1
# </GEN>

RD n=NIA     d=0x0
RD n=GPR i=1 d=10
RD n=GPR i=2 d=20

TRACE

I ea=0x0 id=1
R n=PRE_CYCLE_COUNT d=0x00000001
R n=POST_CYCLE_COUNT d=0x00000001
R n=PRE_CYCLE_COUNT d=0x00000002
M n=Mem t=ifetch ea=0x0 ra=0x0 d=0x7c611214
INSTR op=0x7c611214					asm="add r3,r1,r2"
R n=GPR i=3 d=0x0000001e
ITIME t=2
CTIME t=5

I ea=0x4 id=2
R n=POST_CYCLE_COUNT d=0x00000002
R n=PRE_CYCLE_COUNT d=0x00000003
M n=Mem t=ifetch ea=0x4 ra=0x4 d=0x7c810a14
INSTR op=0x7c810a14					asm="add r4,r1,r1"
R n=GPR i=4 d=0x00000014
R n=POST_CYCLE_COUNT d=0x00000003
R n=PRE_CYCLE_COUNT d=0x00000004
ITIME t=3
R n=POST_CYCLE_COUNT d=0x00000004
R n=PRE_CYCLE_COUNT d=0x00000005
CTIME t=6

I ea=0x8 id=3
R n=POST_CYCLE_COUNT d=0x00000005
R n=PRE_CYCLE_COUNT d=0x00000006
M n=Mem t=ifetch ea=0x8 ra=0x8 d=0x7ca21214
INSTR op=0x7ca21214					asm="add r5,r2,r2"
R n=GPR i=5 d=0x00000028
ITIME t=6
CTIME t=9

I ea=0xc id=4
R n=POST_CYCLE_COUNT d=0x00000006
R n=PRE_CYCLE_COUNT d=0x00000007
M n=Mem t=ifetch ea=0xc ra=0xc d=0x7c210a14
INSTR op=0x7c210a14					asm="add r1,r1,r1"
R n=GPR i=1 d=0x00000014
R n=POST_CYCLE_COUNT d=0x00000007
R n=PRE_CYCLE_COUNT d=0x00000008
ITIME t=7
R n=POST_CYCLE_COUNT d=0x00000008
R n=PRE_CYCLE_COUNT d=0x00000009
CTIME t=10

I ea=0x10 id=5
R n=POST_CYCLE_COUNT d=0x00000009
R n=PRE_CYCLE_COUNT d=0x0000000a
M n=Mem t=ifetch ea=0x10 ra=0x10 d=0x7c210a14
INSTR op=0x7c210a14					asm="add r1,r1,r1"
R n=GPR i=1 d=0x00000028
ITIME t=10
CTIME t=13

I ea=0x14 id=6
R n=POST_CYCLE_COUNT d=0x0000000a
R n=PRE_CYCLE_COUNT d=0x0000000b
M n=Mem t=ifetch ea=0x14 ra=0x14 d=0x7c6803a6
INSTR op=0x7c6803a6					asm="mtlr r3"
R n=LR d=0x0000001e
R n=POST_CYCLE_COUNT d=0x0000000b
R n=PRE_CYCLE_COUNT d=0x0000000c
ITIME t=11
R n=POST_CYCLE_COUNT d=0x0000000c
R n=PRE_CYCLE_COUNT d=0x0000000d
CTIME t=14

I ea=0x18 id=7
R n=POST_CYCLE_COUNT d=0x0000000d
R n=PRE_CYCLE_COUNT d=0x0000000e
M n=Mem t=ifetch ea=0x18 ra=0x18 d=0x7c210a14
INSTR op=0x7c210a14					asm="add r1,r1,r1"
R n=GPR i=1 d=0x00000050
ITIME t=14
CTIME t=17

I ea=0x1c id=8
R n=POST_CYCLE_COUNT d=0x0000000e
R n=PRE_CYCLE_COUNT d=0x0000000f
M n=Mem t=ifetch ea=0x1c ra=0x1c d=0x7c210a14
INSTR op=0x7c210a14					asm="add r1,r1,r1"
R n=GPR i=1 d=0x000000a0
R n=POST_CYCLE_COUNT d=0x0000000f
R n=PRE_CYCLE_COUNT d=0x00000010
R n=POST_CYCLE_COUNT d=0x00000010
R n=PRE_CYCLE_COUNT d=0x00000011
R n=POST_CYCLE_COUNT d=0x00000011
R n=PRE_CYCLE_COUNT d=0x00000012
ITIME t=17
R n=POST_CYCLE_COUNT d=0x00000012
R n=PRE_CYCLE_COUNT d=0x00000013
CTIME t=20

I ea=0x20 id=9
R n=POST_CYCLE_COUNT d=0x00000013
R n=PRE_CYCLE_COUNT d=0x00000014
M n=Mem t=ifetch ea=0x20 ra=0x20 d=0x00000000
INSTR op=0x00000000					asm="halt "
R n=POST_CYCLE_COUNT d=0x00000014
R n=PRE_CYCLE_COUNT d=0x00000015
ITIME t=20
R n=POST_CYCLE_COUNT d=0x00000015
R n=PRE_CYCLE_COUNT d=0x00000016
R n=POST_CYCLE_COUNT d=0x00000016
R n=PRE_CYCLE_COUNT d=0x00000017
R n=POST_CYCLE_COUNT d=0x00000017
R n=PRE_CYCLE_COUNT d=0x00000018
CTIME t=23

RESULTS

RD n=GPR i=0 d=0x00000000
RD n=GPR i=1 d=0x000000a0
RD n=GPR i=2 d=0x00000014
RD n=GPR i=3 d=0x0000001e
RD n=GPR i=4 d=0x00000014
RD n=GPR i=5 d=0x00000028

RD n=POST_CYCLE_COUNT d=0x00000018
RD n=PRE_CYCLE_COUNT d=0x00000018
RD n=LR d=0x0000001e
