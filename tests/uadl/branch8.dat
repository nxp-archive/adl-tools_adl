#
# Test to make sure that a branch which is predicted taken, but then not taken,
# doesn't allow the next instruction to be executed (in issue) on the same cycle
# in a safe-mode model.  In this case, the add r2,r2,-1 would execute an extra
# time if that occurs.
#
= asm

	li r3,3
	li r2,2
	mtctr r3
L1:
	cmpwi r2,0
	bne L2
	addi r10,r10,1
L2:
	addi r2,r2,-1
	bdnz L1

= /asm

# <GEN>
MD n=Mem ra=0x00000000 d=0x38600003	#	li r3,3
MD n=Mem ra=0x00000004 d=0x38400002	#	li r2,2
MD n=Mem ra=0x00000008 d=0x7C6903A6	#	mtctr r3
MD n=Mem ra=0x0000000c d=0x2C020000	#	cmpwi r2,0
MD n=Mem ra=0x00000010 d=0x40820008	#	bne L2
MD n=Mem ra=0x00000014 d=0x394A0001	#	addi r10,r10,1
MD n=Mem ra=0x00000018 d=0x3842FFFF	#	addi r2,r2,-1
MD n=Mem ra=0x0000001c d=0x4200FFF0	#	bdnz L1
# </GEN>

CORE n=:P

RD n=NIA d=0

TRACE

I ea=0x0 id=1 tic=1
T n=TlbCam t=instr ea=0x0 ra=0x0  E=0x0 EPN=0x0 RPN=0x0 SIZE=0x1 SR=0x0 SW=0x0 SX=0x0 TID=0x0 TS=0x0 UR=0x0 UW=0x0 UX=0x0 V=0x0 WIMG=0x0 XXX=0x0
M n=Mem t=ifetch ea=0x0 ra=0x0 d=0x38600003
INSTR op=0x38600003					asm="li r3,3"
R n=GPR i=3 d=0x00000003
ITIME t=2
CTIME t=5

I ea=0x4 id=2 tic=2
T n=TlbCam t=instr ea=0x4 ra=0x4  E=0x0 EPN=0x0 RPN=0x0 SIZE=0x1 SR=0x0 SW=0x0 SX=0x0 TID=0x0 TS=0x0 UR=0x0 UW=0x0 UX=0x0 V=0x0 WIMG=0x0 XXX=0x0
M n=Mem t=ifetch ea=0x4 ra=0x4 d=0x38400002
INSTR op=0x38400002					asm="li r2,2"
R n=GPR i=2 d=0x00000002
ITIME t=2
CTIME t=5

I ea=0x8 id=3 tic=3
T n=TlbCam t=instr ea=0x8 ra=0x8  E=0x0 EPN=0x0 RPN=0x0 SIZE=0x1 SR=0x0 SW=0x0 SX=0x0 TID=0x0 TS=0x0 UR=0x0 UW=0x0 UX=0x0 V=0x0 WIMG=0x0 XXX=0x0
M n=Mem t=ifetch ea=0x8 ra=0x8 d=0x7c6903a6
INSTR op=0x7c6903a6					asm="mtctr r3"
R n=CTR d=0x00000003
ITIME t=3
CTIME t=6

I ea=0xc id=4 tic=4
T n=TlbCam t=instr ea=0xc ra=0xc  E=0x0 EPN=0x0 RPN=0x0 SIZE=0x1 SR=0x0 SW=0x0 SX=0x0 TID=0x0 TS=0x0 UR=0x0 UW=0x0 UX=0x0 V=0x0 WIMG=0x0 XXX=0x0
M n=Mem t=ifetch ea=0xc ra=0xc d=0x2c020000
INSTR op=0x2c020000					asm="cmpwi r2,0"
R n=CR d=0x40000000
ITIME t=3
CTIME t=6

I ea=0x10 id=5 tic=5
T n=TlbCam t=instr ea=0x10 ra=0x10  E=0x0 EPN=0x0 RPN=0x0 SIZE=0x1 SR=0x0 SW=0x0 SX=0x0 TID=0x0 TS=0x0 UR=0x0 UW=0x0 UX=0x0 V=0x0 WIMG=0x0 XXX=0x0
M n=Mem t=ifetch ea=0x10 ra=0x10 d=0x40820008
INSTR op=0x40820008					asm="bne- 0x0000000000000018"
B taken=1 ea=0x18
ITIME t=4
CTIME t=7

I ea=0x18 id=6 tic=6
T n=TlbCam t=instr ea=0x18 ra=0x18  E=0x0 EPN=0x0 RPN=0x0 SIZE=0x1 SR=0x0 SW=0x0 SX=0x0 TID=0x0 TS=0x0 UR=0x0 UW=0x0 UX=0x0 V=0x0 WIMG=0x0 XXX=0x0
M n=Mem t=ifetch ea=0x18 ra=0x18 d=0x3842ffff
INSTR op=0x3842ffff					asm="addi r2,r2,-1"
R n=GPR i=2 d=0x00000001
ITIME t=6
CTIME t=9

I ea=0x1c id=7 tic=7
T n=TlbCam t=instr ea=0x1c ra=0x1c  E=0x0 EPN=0x0 RPN=0x0 SIZE=0x1 SR=0x0 SW=0x0 SX=0x0 TID=0x0 TS=0x0 UR=0x0 UW=0x0 UX=0x0 V=0x0 WIMG=0x0 XXX=0x0
M n=Mem t=ifetch ea=0x1c ra=0x1c d=0x4200fff0
INSTR op=0x4200fff0					asm="bdnz+ 0x000000000000000c"
R n=CTR d=0x00000002
B taken=1 ea=0xc
ITIME t=6
CTIME t=9

I ea=0xc id=8 tic=8
T n=TlbCam t=instr ea=0xc ra=0xc  E=0x0 EPN=0x0 RPN=0x0 SIZE=0x1 SR=0x0 SW=0x0 SX=0x0 TID=0x0 TS=0x0 UR=0x0 UW=0x0 UX=0x0 V=0x0 WIMG=0x0 XXX=0x0
M n=Mem t=ifetch ea=0xc ra=0xc d=0x2c020000
INSTR op=0x2c020000					asm="cmpwi r2,0"
R n=CR d=0x40000000
ITIME t=8
CTIME t=11

I ea=0x10 id=9 tic=9
T n=TlbCam t=instr ea=0x10 ra=0x10  E=0x0 EPN=0x0 RPN=0x0 SIZE=0x1 SR=0x0 SW=0x0 SX=0x0 TID=0x0 TS=0x0 UR=0x0 UW=0x0 UX=0x0 V=0x0 WIMG=0x0 XXX=0x0
M n=Mem t=ifetch ea=0x10 ra=0x10 d=0x40820008
INSTR op=0x40820008					asm="bne- 0x0000000000000018"
B taken=1 ea=0x18
ITIME t=9
CTIME t=12

I ea=0x18 id=10 tic=10
T n=TlbCam t=instr ea=0x18 ra=0x18  E=0x0 EPN=0x0 RPN=0x0 SIZE=0x1 SR=0x0 SW=0x0 SX=0x0 TID=0x0 TS=0x0 UR=0x0 UW=0x0 UX=0x0 V=0x0 WIMG=0x0 XXX=0x0
M n=Mem t=ifetch ea=0x18 ra=0x18 d=0x3842ffff
INSTR op=0x3842ffff					asm="addi r2,r2,-1"
R n=GPR i=2 d=0x00000000
ITIME t=9
CTIME t=12

I ea=0x1c id=11 tic=11
T n=TlbCam t=instr ea=0x1c ra=0x1c  E=0x0 EPN=0x0 RPN=0x0 SIZE=0x1 SR=0x0 SW=0x0 SX=0x0 TID=0x0 TS=0x0 UR=0x0 UW=0x0 UX=0x0 V=0x0 WIMG=0x0 XXX=0x0
M n=Mem t=ifetch ea=0x1c ra=0x1c d=0x4200fff0
INSTR op=0x4200fff0					asm="bdnz+ 0x000000000000000c"
R n=CTR d=0x00000001
B taken=1 ea=0xc
ITIME t=10
CTIME t=13

I ea=0xc id=12 tic=12
T n=TlbCam t=instr ea=0xc ra=0xc  E=0x0 EPN=0x0 RPN=0x0 SIZE=0x1 SR=0x0 SW=0x0 SX=0x0 TID=0x0 TS=0x0 UR=0x0 UW=0x0 UX=0x0 V=0x0 WIMG=0x0 XXX=0x0
M n=Mem t=ifetch ea=0xc ra=0xc d=0x2c020000
INSTR op=0x2c020000					asm="cmpwi r2,0"
R n=CR d=0x20000000
ITIME t=10
CTIME t=13

I ea=0x10 id=13 tic=13
T n=TlbCam t=instr ea=0x10 ra=0x10  E=0x0 EPN=0x0 RPN=0x0 SIZE=0x1 SR=0x0 SW=0x0 SX=0x0 TID=0x0 TS=0x0 UR=0x0 UW=0x0 UX=0x0 V=0x0 WIMG=0x0 XXX=0x0
M n=Mem t=ifetch ea=0x10 ra=0x10 d=0x40820008
INSTR op=0x40820008					asm="bne- 0x0000000000000018"
ITIME t=11
CTIME t=14

I ea=0x14 id=14 tic=14
T n=TlbCam t=instr ea=0x14 ra=0x14  E=0x0 EPN=0x0 RPN=0x0 SIZE=0x1 SR=0x0 SW=0x0 SX=0x0 TID=0x0 TS=0x0 UR=0x0 UW=0x0 UX=0x0 V=0x0 WIMG=0x0 XXX=0x0
M n=Mem t=ifetch ea=0x14 ra=0x14 d=0x394a0001
INSTR op=0x394a0001					asm="addi r10,r10,1"
R n=GPR i=10 d=0x00000001
ITIME t=13
CTIME t=16

I ea=0x18 id=15 tic=15
T n=TlbCam t=instr ea=0x18 ra=0x18  E=0x0 EPN=0x0 RPN=0x0 SIZE=0x1 SR=0x0 SW=0x0 SX=0x0 TID=0x0 TS=0x0 UR=0x0 UW=0x0 UX=0x0 V=0x0 WIMG=0x0 XXX=0x0
M n=Mem t=ifetch ea=0x18 ra=0x18 d=0x3842ffff
INSTR op=0x3842ffff					asm="addi r2,r2,-1"
R n=GPR i=2 d=0xffffffff
ITIME t=13
CTIME t=16

I ea=0x1c id=16 tic=16
T n=TlbCam t=instr ea=0x1c ra=0x1c  E=0x0 EPN=0x0 RPN=0x0 SIZE=0x1 SR=0x0 SW=0x0 SX=0x0 TID=0x0 TS=0x0 UR=0x0 UW=0x0 UX=0x0 V=0x0 WIMG=0x0 XXX=0x0
M n=Mem t=ifetch ea=0x1c ra=0x1c d=0x4200fff0
INSTR op=0x4200fff0					asm="bdnz+ 0x000000000000000c"
R n=CTR d=0x00000000
ITIME t=14
CTIME t=17

I ea=0x20 id=17 tic=17
T n=TlbCam t=instr ea=0x20 ra=0x20  E=0x0 EPN=0x0 RPN=0x0 SIZE=0x1 SR=0x0 SW=0x0 SX=0x0 TID=0x0 TS=0x0 UR=0x0 UW=0x0 UX=0x0 V=0x0 WIMG=0x0 XXX=0x0
M n=Mem t=ifetch ea=0x20 ra=0x20 d=0x00000000
INSTR op=0x00000000					asm="halt "
ITIME t=17
CTIME t=20

RESULTS

RD n=GPR i=2 d=0xffffffff
RD n=GPR i=3 d=0x00000003
