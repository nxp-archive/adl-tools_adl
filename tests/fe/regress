#!/usr/bin/env perl 
# -- -*-perl-*-a
#
# Tests used in this regression.

use FindBin;
use lib "$FindBin::RealBin/../../scripts";
use rdriver;
use strict;
use regress_utils;
use Data::Dumper;
use Cwd;

use vars qw($src $adldump);

my @Tests = (
	failtest ("reg1"),
	passtest ("reg2"),
	failtest ("reg3"),
	failtest ("reg4"),
	failtest ("reg5"),
	passtest ("reg6"),
	passtest ("reg7"),
	passtest ("reg8"),
	failtest ("reg9"),
	failtest ("reg10"),
	failtest ("reg11"),
	passtest ("reg12"),
	passtest ("reg13"),
	passtest ("reg14"),
	failtest ("reg15"),
	failtest ("reg16"),
	failtest ("reg17"),
	failtest ("reg18"),
	passtest ("reg19"),
	failtest ("reg20"),
	passtest ("reg21"),
	failtest ("reg22"),
	failtest ("reg23"),
	passtest ("reg24"),
	failtest ("reg25"),
	passtest ("reg26"),
	passtest ("reg27"),
	failtest ("reg28"),
	passtest ("reg29"),
	failtest ("reg30"),
	failtest ("reg31"),
	failtest ("reg32"),
	passtest ("reg33"),
	passtest ("reg34"),
	failtest ("reg35"),
	passtest ("reg36","--data-model-debug"),
	passtest ("reg37","--data-model-debug"),
	failtest ("reg38"),
	passtest ("reg39","--data-model-debug"),
	passtest ("reg40","--data-model-debug"),
	passtest ("reg41","--data-model-debug"),
	failtest ("reg42"),
	passtest ("reg43"),
	passtest ("reg44"),
	passtest ("reg45"),
	passtest ("reg46"),
	failtest ("reg47"),
	passtest ("reg48"),
	passtest ("reg49"),
	passtest ("inst1"),
	failtest ("inst2"),
	passtest ("inst3"),
	failtest ("inst4"),
	failtest ("inst5"),
	failtest ("inst6"),
	failtest ("inst7"),
	passtest ("inst8"),
	passtest ("inst9"),
	passtest ("inst10","--strict"),
	passtest ("inst11"),
	failtest ("inst12"),
	passtest ("inst13"),
	failtest ("inst14"),
	passtest ("inst15"),
	failtest ("inst16"),
	passtest ("inst17"),
	failtest ("inst18"),
	passtest ("inst19"),
	failtest ("inst20"),
	passtest ("inst21"),
	passtest ("inst22"),
	passtest ("inst23"),
	passtest ("inst24"),
	passtest ("inst25"),
	passtest ("inst26"),
	passtest ("inst27"),
	failtest ("inst28"),
	passtest ("inst29"),
	passtest ("inst30"),
	failtest ("inst31"),
	failtest ("inst32"),
	passtest ("inst33"),
	passtest ("inst34"),
	passtest ("inst35"),
	passtest ("inst36"),
	passtest ("inst37"),
	failtest ("inst38"),
	passtest ("inst39"),
	passtest ("inst40"),
	failtest ("inst41"),
	passtest ("inst42"),
	failtest ("inst43"),
	passtest ("inst44"),			 
	failtest ("inst45"),
	passtest ("inst46","--data-model-debug"),
	passtest ("inst47"),
	passtest ("inst48"),
	passtest ("inst49"),			 
	passtest ("inst50"),
	passtest ("inst51"),
	failtest ("inst52"),
	passtest ("inst53"),
	failtest ("inst54"),
	passtest ("inst55"),
	failtest ("inst56"),
	failtest ("inst57"),
	passtest ("inst58"),
	passtest ("inst59"),
	failtest ("inst60"),
	passtest ("inst61"),
	passtest ("inst62"),
	failtest ("inst63"),
	passtest ("inst64"),
	passtest ("inst65"),
	passtest ("inst66"),
	failtest ("inst68"),
	passtest ("inst69"),
	failtest ("inst70"),
	passtest ("inst72"),
	failtest ("inst73"),
	failtest ("inst74"),
	passtest ("inst75"),
	passtest ("inst76"),
	passtest ("inst77"),
	passtest ("inst78"),
	failtest ("inst79"),
	passtest ("inst80"),
	passtest ("inst81"),
	passtest ("inst82"),
	passtest ("inst83"),
	passtest ("inst84"),
	passtest ("inst85"),
	passtest ("inst86"),
	passtest ("inst87"),
	passtest ("inst88"),
	passtest ("inst89"),
	passtest ("inst90"),
	passtest ("inst91"),
	passtest ("inst92"),
	passtest ("inst93"),
	passtest ("inst94"),
	passtest ("inst95"),
	passtest ("inst96","--strict"),
	failtest ("inst97"),
	passtest ("inst98"),
	passtest ("inst99"),
	passtest ("inst100"),
	passtest ("inst101"),
	passtest ("inst102"),
	passtest ("inst103"),
	passtest ("inst104"),
	passtest ("inst105"),
	passtest ("inst106"),
	passtest ("inst107"),
	passtest ("inst108","--data-model-debug"),
	passtest ("inst109"),
	failtest ("inst110"),
	failtest ("inst111"),
	failtest ("inst112"),
	passtest ("inst113"),
	passtest ("inst114","--data-model-debug"),
	passtest ("inst115"),
	passtest ("inst116"),
	passtest ("inst117"),
	failtest ("inst118"),
	passtest ("inst119"),
	passtest ("inst120"),
	failtest ("inst121"),
	passtest ("inst122"),
	passtest ("inst123"),
	passtest ("inst124"),
	passtest ("inst125"),
	passtest ("inst126"),
	passtest ("inst127"),
	passtest ("inst128"),
	passtest ("inst129"),
	passtest ("inst130"),
	passtest ("inst131"),
	passtest ("inst132"),
	passtest ("inst133"),
	passtest ("inst134"),
	passtest ("inst135"),
	failtest ("inst136"),
	passtest ("inst137"),
	passtest ("inst138"),
	passtest ("inst139"),
	failtest ("inst140"),
	passtest ("inst141"),
	passtest ("inst142"),
	failtest ("inst143"),
	failtest ("inst144"),
	failtest ("inst145"),
	failtest ("inst146"),
	passtest ("inst147"),
	passtest ("inst148"),
	passtest ("inst149"),	
	passtest ("ex1"),
	passtest ("ex2"),
	passtest ("ex3"),
	failtest ("ex4"),
	failtest ("parm1"),
	passtest ("parm2"),
	failtest ("parm3"),
	passtest ("parm4"),
	failtest ("as1"),
	passtest ("as2"),
	passtest ("as3","--data-model-debug"),
	passtest ("as4"),
	passtest ("as5"),
	passtest ("as6"),
	passtest ("as7"),
	passtest ("as8"),
	passtest ("as9"),
	passtest ("as10"),
	passtest ("share1"),
	failtest ("share2"),
	failtest ("share3"),
	passtest ("share4"),
	failtest ("share5"),
	passtest ("share6"),
	failtest ("share7"),
	passtest ("share8"),
	passtest ("share9"),
	failtest ("share10"),
	failtest ("share11"),
	passtest ("share12"),
	passtest ("share13"),
	passtest ("share14"),
	failtest ("share15"),
	failtest ("share16"),
	passtest ("share17"),
	passtest ("share18"),
	{
		cmd    => "./simple $src/s1.in",
		diff   => "$src/s1.regress",
		stdio  => 1,
	},
	passtest ("mmu1"),
	failtest ("mmu2"),
	failtest ("mmu3"),
	failtest ("mmu4"),
	passtest ("mmu5"),
	passtest ("mmu6"),
	failtest ("mmu7"),
	passtest ("mmu8"),
	passtest ("mmu9"),
	failtest ("mmu10"),
	failtest ("mmu11"),
	passtest ("mmu12"),
	passtest ("mmu13"),
	failtest ("mmu14"),
	passtest ("mmu15"),
	passtest ("mmu16"),
	failtest ("mmu17"),
	failtest ("mmu18"),
	passtest ("mmu19"),
	passtest ("mmu20"),
	failtest ("mem1"),
	passtest("mem2"),
	failtest("mem3"),
	failtest("mem4"),
	passtest("mem5"),
	failtest("mem6"),
	passtest("mem7"),
	failtest("mem8"),
	failtest("mem9"),
	passtest("mem10"),
	passtest("mem11","--data-model-debug"),
	passtest ("cache1"),
	failtest ("cache2"),
	failtest ("cache3"),
	passtest ("cache4"),
	failtest ("cache5"),
	passtest ("cache6"),
	failtest ("cache7"),
	failtest ("cache8"),
	failtest ("cache9"),
	passtest ("helpers1"),
	failtest ("helpers2"),
	# Removed b/c we now do allow outer-level declarations and such.
	#failtest ("helpers3"),
	#failtest ("helpers4"),
	passtest ("helpers5"),
	passtest ("helpers6"),
	passtest ("helpers7"),
	passtest ("helpers8"),
	passtest ("helpers9"),
	passtest ("helpers10"),
	passtest ("helpers11"),
	passtest ("helpers12"),
	passtest ("helpers13"),
	passtest ("helpers14"),
	passtest ("helpers15"),
	passtest ("helpers16"),
	passtest ("helpers17"),
	passtest ("helpers18"),
	passtest ("helpers19"),
	passtest ("helpers20"),
	passtest ("helpers21"),
	passtest ("helpers22"),
	passtest ("bus1"),
	failtest ("bus2"),
	passtest ("extres1"),
	passtest ("ctx1"),
	failtest ("ctx2"),
	failtest ("ctx3"),
	passtest ("ctx4"),
	failtest ("ctx5"),
	passtest ("attr1"),
	failtest ("attr2"),
	passtest ("attr3"),
	passtest ("attr4"),
	failtest ("attr5"),
	passtest ("attr6"),
	passtest ("attr7"),
	passtest ("attr8"),
	passtest ("attr9"),
	passtest ("group1"),
	passtest ("group2"),
	failtest ("group3"),
	failtest ("group4"),
	passtest ("group5","--strict"),
	failtest ("group6","--strict"),
	passtest ("group7"),
	passtest ("group8"),
	passtest ("group9"),
	passtest ("group10"),
	passtest ("group11"),
	passtest ("group12"),
	passtest ("littleEnd1"),
	failtest ("littleEnd2"),
	passtest ("littleEnd3"),
	passtest ("asm1"),
	failtest ("asm2"),
	failtest ("asm3"),
	failtest ("asm4"),
	failtest ("asm5"),
	failtest ("asm6"),
	passtest ("asm7"),
	failtest ("asm8"),
	passtest ("asm9"),
	passtest ("asm10"),
	passtest ("asm11"),	
	passtest ("remove1"),
	passtest ("delay1"),
	failtest ("delay2"),
	passtest ("delay3"),
	passtest ("dep1"),
	failtest ("dep2"),
	failtest ("microinstr1"),
	passtest ("microinstr2"),
	failtest ("microinstr3"),
	passtest ("microinstr4"),
	passtest ("microinstr5"),
	failtest ("microinstr7"),
    );

# Create a test that's expected to pass.
# arg0:  Basename of file. Input is arg0.adl, golden is arg0.regress.
# arg1:  Optional additional arguments.
sub passtest($) {
  my ($file,$opts) = @_;
  return {
		  cmd    => "$adldump --no-full-path-errors $opts $src/$file.adl",
		  diff   => "$src/$file.regress",
		  stdio  => 1,
		  stderr => 1,
		 };
}

# Create a test that's expected to fail.
# arg0:  Basename of file.  Input is arg0.adl, golden is arg0.regress.
sub failtest($) {
  my ($file) = @_;
  return {
		  cmd    => "$adldump --no-full-path-errors $src/$file.adl",
		  diff   => "$src/$file.regress",
		  stdio  => 1,
		  stderr => 1,
		  fail   => 1,
		 };
}

doTest(\@Tests);

##
## Place test routines here.
## <TESTS>
##


##
## </TESTS>
##
