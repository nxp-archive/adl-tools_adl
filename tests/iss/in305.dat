#
# Testing of per-context MMU lookups.
#
# Note:  Assembled using an assembler generated from mod92.adl.
#
= asm

	addi r1,r1,1
	addi r2,r2,2
	lwz	 r3,0x1000(r0)
	addi r3,r3,4
	stw  r3,0x1004(r0)
	yield
	halt

= /asm

# <GEN>
MD n=Mem ra=0x00000000 d=0x38210001	#	addi r1,r1,1
MD n=Mem ra=0x00000004 d=0x38420002	#	addi r2,r2,2
MD n=Mem ra=0x00000008 d=0x80601000	#	lwz	 r3,0x1000(r0)
MD n=Mem ra=0x0000000c d=0x38630004	#	addi r3,r3,4
MD n=Mem ra=0x00000010 d=0x90601004	#	stw  r3,0x1004(r0)
MD n=Mem ra=0x00000014 d=0x7C0000A8	#	yield
MD n=Mem ra=0x00000018 d=0x00000000	#	halt
# </GEN>

CORE n=:P

TD n=TlbCam0 set=0 way=0 EPN=0 RPN=0 SIZE=1 SX=1 V=1

CTX n=Thread cn=0

# Maps 0x1000 -> 0xA000
TD n=TlbCam1 set=0 way=0 EPN=0x4 RPN=0x28 SIZE=1 SR=1 SW=1 V=1

RD n=NIA d=0x0
RD n=TEN d=0x1

CTX n=Thread cn=1

RD n=NIA d=0x0
RD n=TEN d=0x1

# Maps 0x1000 -> 0xB000
TD n=TlbCam1 set=0 way=0 EPN=0x4 RPN=0x2C SIZE=1 SR=1 SW=1 V=1

MD n=Mem ra=0xa000 d=100
MD n=Mem ra=0xb000 d=200

TRACE

CTX n=Thread cn=0

I ea=0x0 id=1 tic=1
T n=TlbCam0 t=instr set=0 way=0 ea=0x0 ra=0x0  EPN=0x0 RPN=0x0 SIZE=0x1 SR=0x0 SW=0x0 SX=0x1 UR=0x0 UW=0x0 UX=0x0 V=0x1
M n=Mem t=ifetch ea=0x0 ra=0x0 d=0x38210001
INSTR op=0x38210001					asm="addi r1,r1,1"
R n=GPR i=1 d=0x00000001

I ea=0x4 id=2 tic=2
T n=TlbCam0 t=instr set=0 way=0 ea=0x4 ra=0x4  EPN=0x0 RPN=0x0 SIZE=0x1 SR=0x0 SW=0x0 SX=0x1 UR=0x0 UW=0x0 UX=0x0 V=0x1
M n=Mem t=ifetch ea=0x4 ra=0x4 d=0x38420002
INSTR op=0x38420002					asm="addi r2,r2,2"
R n=GPR i=2 d=0x00000002

I ea=0x8 id=3 tic=3
T n=TlbCam0 t=instr set=0 way=0 ea=0x8 ra=0x8  EPN=0x0 RPN=0x0 SIZE=0x1 SR=0x0 SW=0x0 SX=0x1 UR=0x0 UW=0x0 UX=0x0 V=0x1
M n=Mem t=ifetch ea=0x8 ra=0x8 d=0x80601000
INSTR op=0x80601000					asm="lwz r3,4096(r0)"
D n=Mem t=read ea=0x1000 nb=4
T n=TlbCam1 t=load set=0 way=0 ea=0x1000 ra=0xa000  EPN=0x4 RPN=0x28 SIZE=0x1 SR=0x1 SW=0x1 SX=0x0 UR=0x0 UW=0x0 UX=0x0 V=0x1
M n=Mem t=read ea=0x1000 ra=0xa000 d=0x00000064
R n=GPR i=3 d=0x00000064

I ea=0xc id=4 tic=4
T n=TlbCam0 t=instr set=0 way=0 ea=0xc ra=0xc  EPN=0x0 RPN=0x0 SIZE=0x1 SR=0x0 SW=0x0 SX=0x1 UR=0x0 UW=0x0 UX=0x0 V=0x1
M n=Mem t=ifetch ea=0xc ra=0xc d=0x38630004
INSTR op=0x38630004					asm="addi r3,r3,4"
R n=GPR i=3 d=0x00000068

I ea=0x10 id=5 tic=5
T n=TlbCam0 t=instr set=0 way=0 ea=0x10 ra=0x10  EPN=0x0 RPN=0x0 SIZE=0x1 SR=0x0 SW=0x0 SX=0x1 UR=0x0 UW=0x0 UX=0x0 V=0x1
M n=Mem t=ifetch ea=0x10 ra=0x10 d=0x90601004
INSTR op=0x90601004					asm="stw r3,4100(r0)"
D n=Mem t=write ea=0x1004 nb=4
T n=TlbCam1 t=store set=0 way=0 ea=0x1004 ra=0xa004  EPN=0x4 RPN=0x28 SIZE=0x1 SR=0x1 SW=0x1 SX=0x0 UR=0x0 UW=0x0 UX=0x0 V=0x1
M n=Mem t=write ea=0x1004 ra=0xa004 d=0x00000068

I ea=0x14 id=6 tic=6
T n=TlbCam0 t=instr set=0 way=0 ea=0x14 ra=0x14  EPN=0x0 RPN=0x0 SIZE=0x1 SR=0x0 SW=0x0 SX=0x1 UR=0x0 UW=0x0 UX=0x0 V=0x1
M n=Mem t=ifetch ea=0x14 ra=0x14 d=0x7c0000a8
INSTR op=0x7c0000a8					asm="yield "
R n=TACTIVE d=0x00000001

CTX n=Thread cn=1

I ea=0x0 id=7 tic=7
T n=TlbCam0 t=instr set=0 way=0 ea=0x0 ra=0x0  EPN=0x0 RPN=0x0 SIZE=0x1 SR=0x0 SW=0x0 SX=0x1 UR=0x0 UW=0x0 UX=0x0 V=0x1
M n=Mem t=ifetch ea=0x0 ra=0x0 d=0x38210001
INSTR op=0x38210001					asm="addi r1,r1,1"
R n=GPR i=1 d=0x00000001

I ea=0x4 id=8 tic=8
T n=TlbCam0 t=instr set=0 way=0 ea=0x4 ra=0x4  EPN=0x0 RPN=0x0 SIZE=0x1 SR=0x0 SW=0x0 SX=0x1 UR=0x0 UW=0x0 UX=0x0 V=0x1
M n=Mem t=ifetch ea=0x4 ra=0x4 d=0x38420002
INSTR op=0x38420002					asm="addi r2,r2,2"
R n=GPR i=2 d=0x00000002

I ea=0x8 id=9 tic=9
T n=TlbCam0 t=instr set=0 way=0 ea=0x8 ra=0x8  EPN=0x0 RPN=0x0 SIZE=0x1 SR=0x0 SW=0x0 SX=0x1 UR=0x0 UW=0x0 UX=0x0 V=0x1
M n=Mem t=ifetch ea=0x8 ra=0x8 d=0x80601000
INSTR op=0x80601000					asm="lwz r3,4096(r0)"
D n=Mem t=read ea=0x1000 nb=4
T n=TlbCam1 t=load set=0 way=0 ea=0x1000 ra=0xb000  EPN=0x4 RPN=0x2c SIZE=0x1 SR=0x1 SW=0x1 SX=0x0 UR=0x0 UW=0x0 UX=0x0 V=0x1
M n=Mem t=read ea=0x1000 ra=0xb000 d=0x000000c8
R n=GPR i=3 d=0x000000c8

I ea=0xc id=10 tic=10
T n=TlbCam0 t=instr set=0 way=0 ea=0xc ra=0xc  EPN=0x0 RPN=0x0 SIZE=0x1 SR=0x0 SW=0x0 SX=0x1 UR=0x0 UW=0x0 UX=0x0 V=0x1
M n=Mem t=ifetch ea=0xc ra=0xc d=0x38630004
INSTR op=0x38630004					asm="addi r3,r3,4"
R n=GPR i=3 d=0x000000cc

I ea=0x10 id=11 tic=11
T n=TlbCam0 t=instr set=0 way=0 ea=0x10 ra=0x10  EPN=0x0 RPN=0x0 SIZE=0x1 SR=0x0 SW=0x0 SX=0x1 UR=0x0 UW=0x0 UX=0x0 V=0x1
M n=Mem t=ifetch ea=0x10 ra=0x10 d=0x90601004
INSTR op=0x90601004					asm="stw r3,4100(r0)"
D n=Mem t=write ea=0x1004 nb=4
T n=TlbCam1 t=store set=0 way=0 ea=0x1004 ra=0xb004  EPN=0x4 RPN=0x2c SIZE=0x1 SR=0x1 SW=0x1 SX=0x0 UR=0x0 UW=0x0 UX=0x0 V=0x1
M n=Mem t=write ea=0x1004 ra=0xb004 d=0x000000cc

I ea=0x14 id=12 tic=12
T n=TlbCam0 t=instr set=0 way=0 ea=0x14 ra=0x14  EPN=0x0 RPN=0x0 SIZE=0x1 SR=0x0 SW=0x0 SX=0x1 UR=0x0 UW=0x0 UX=0x0 V=0x1
M n=Mem t=ifetch ea=0x14 ra=0x14 d=0x7c0000a8
INSTR op=0x7c0000a8					asm="yield "

CTX n=Thread cn=0

I ea=0x18 id=13 tic=13
T n=TlbCam0 t=instr set=0 way=0 ea=0x18 ra=0x18  EPN=0x0 RPN=0x0 SIZE=0x1 SR=0x0 SW=0x0 SX=0x1 UR=0x0 UW=0x0 UX=0x0 V=0x1
M n=Mem t=ifetch ea=0x18 ra=0x18 d=0x00000000
INSTR op=0x00000000					asm="halt "

RESULTS

MD n=Mem ra=0xa000 d=100
MD n=Mem ra=0xb000 d=200
