#
# This makes sure that setting a register at a 
# system-level in the hierarchy will update
# any parameters in the cores.  This also checks
# that a shared parameter will work.
#
# <ASM>
# mfspr 5,51
# mtspr 50,6
# bc 20,0,L3
# mfspr 5,51
# ori 0,0,0
# ori 0,0,0
# mfspr 6,51
# L3:
# </ASM>
# <GEN>
MD n=Mem ra=0x00000000 d=0x7CB30AA6	# mfspr 5,51
MD n=Mem ra=0x00000004 d=0x7CD20BA6	# mtspr 50,6
MD n=Mem ra=0x00000008 d=0x42800014	# bc 20,0,L3
MD n=Mem ra=0x0000000c d=0x7CB30AA6	# mfspr 5,51
MD n=Mem ra=0x00000010 d=0x60000000	# ori 0,0,0
MD n=Mem ra=0x00000014 d=0x60000000	# ori 0,0,0
MD n=Mem ra=0x00000018 d=0x7CD30AA6	# mfspr 6,51
# </GEN>

CORE n=PMT

RD n=TEN d=0xc0000000

CORE n=PMT

RD n=HID0 d=0x80000000

CORE n=PMT:t0

RD n=NIA0 d=0x0

CORE n=PMT:t1

RD n=NIA1 d=0xc

TRACE

CORE n=:PMT:t0

I id=1 ea=0x0
M n=Mem t=ifetch ea=0x0 ra=0x0 d=0x7cb30aa6
INSTR op=0x7cb30aa6 asm="#1 mfspr 5,51"
R n=GPR i=5 d=0x12345678

I id=2 ea=0x4
M n=Mem t=ifetch ea=0x4 ra=0x4 d=0x7cd20ba6
INSTR op=0x7cd20ba6 asm="#3 mtspr 6,50"
R n=HID0 d=0x00000000

I id=3 ea=0x8
M n=Mem t=ifetch ea=0x8 ra=0x8 d=0x42800014
INSTR op=0x42800014 asm="#5 bc 20,0,5"

I id=4 ea=0x1c
M n=Mem t=ifetch ea=0x1c ra=0x1c d=0x0
INSTR op=0x0 asm="#7 halt"

CORE n=:PMT:t1

I id=5 ea=0xc
M n=Mem t=ifetch ea=0xc ra=0xc d=0x7cb30aa6
INSTR op=0x7cb30aa6 asm="#2 mfspr 5,51"
R n=GPR i=5 d=0x12345678

I id=6 ea=0x10
M n=Mem t=ifetch ea=0x10 ra=0x10 d=0x60000000
INSTR op=0x60000000 asm="#4 ori 0,0,0"
R n=GPR i=0 d=0x00000000

I id=7 ea=0x14
M n=Mem t=ifetch ea=0x14 ra=0x14 d=0x60000000
INSTR op=0x60000000 asm="#6 ori 0,0,0"
R n=GPR i=0 d=0x00000000

I id=8 ea=0x18
M n=Mem t=ifetch ea=0x18 ra=0x18 d=0x7cd30aa6
INSTR op=0x7cd30aa6 asm="#8 mfspr 6,51"
R n=GPR i=6 d=0xdeadbeef

I id=9 ea=0x1c
M n=Mem t=ifetch ea=0x1c ra=0x1c d=0x0
INSTR op=0x0 asm="#9 halt"

RESULTS

CORE n=PMT:t0

RD n=GPR i=5 d=0x12345678

CORE n=PMT:t1

RD n=GPR i=5 d=0x12345678
RD n=GPR i=6 d=0xdeadbeef




