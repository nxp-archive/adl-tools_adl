#
# Tests watch statements on aliased registers.  In this case, SMode has a watch
# on MSR, but MSR is an alias to MSRs via child-indexing.
#
= asm

	mfspr r10,99  # Should be in Super mode.
	mtspr 100,r1  # Convert to User mode.
	mfspr r11,99  # Check the value.
	mtspr 100,r2  # Back to Super.
	mfspr r12,99  # Check the value.
	mtmsr r1      # Back to user mode.
	mfspr r13,99  # Check the value.
	mtmsr r2      # Back to super mode.
	mfspr r14,99  # Check the value.
	
= /asm

# <GEN>
MD n=Mem ra=0x00000000 d=0x7D431AA6	#	mfspr r10,99  # Should be in Super mode.
MD n=Mem ra=0x00000004 d=0x7C241BA6	#	mtspr 100,r1  # Convert to User mode.
MD n=Mem ra=0x00000008 d=0x7D631AA6	#	mfspr r11,99  # Check the value.
MD n=Mem ra=0x0000000c d=0x7C441BA6	#	mtspr 100,r2  # Back to Super.
MD n=Mem ra=0x00000010 d=0x7D831AA6	#	mfspr r12,99  # Check the value.
MD n=Mem ra=0x00000014 d=0x7C200124	#	mtmsr r1      # Back to user mode.
MD n=Mem ra=0x00000018 d=0x7DA31AA6	#	mfspr r13,99  # Check the value.
MD n=Mem ra=0x0000001c d=0x7C400124	#	mtmsr r2      # Back to user mode.
MD n=Mem ra=0x00000020 d=0x7DC31AA6	#	mfspr r14,99  # Check the value.
# </GEN>

CORE n=:PMT:t0

RD n=NIA     d=0x0
RD n=GPR i=1 d=0x80000000
RD n=GPR i=2 d=0x00000000

TRACE

CORE n=:PMT:t0

I ea=0x0 id=1
M n=Mem t=ifetch ea=0x0 ra=0x0 d=0x7d431aa6
INSTR op=0x7d431aa6					asm="mfspr r10,STEST"
R n=GPR i=10 d=0x00000001

I ea=0x4 id=2
M n=Mem t=ifetch ea=0x4 ra=0x4 d=0x7c241ba6
INSTR op=0x7c241ba6					asm="mtspr MSRs0,r1"
R n=MSRs i=0 d=0x80000000

I ea=0x8 id=3
M n=Mem t=ifetch ea=0x8 ra=0x8 d=0x7d631aa6
INSTR op=0x7d631aa6					asm="mfspr r11,STEST"
R n=GPR i=11 d=0x00000000

I ea=0xc id=4
M n=Mem t=ifetch ea=0xc ra=0xc d=0x7c441ba6
INSTR op=0x7c441ba6					asm="mtspr MSRs0,r2"
R n=MSRs i=0 d=0x00000000

I ea=0x10 id=5
M n=Mem t=ifetch ea=0x10 ra=0x10 d=0x7d831aa6
INSTR op=0x7d831aa6					asm="mfspr r12,STEST"
R n=GPR i=12 d=0x00000001

I ea=0x14 id=6
M n=Mem t=ifetch ea=0x14 ra=0x14 d=0x7c200124
INSTR op=0x7c200124					asm="mtmsr r1"
R n=MSR d=0x80000000

I ea=0x18 id=7
M n=Mem t=ifetch ea=0x18 ra=0x18 d=0x7da31aa6
INSTR op=0x7da31aa6					asm="mfspr r13,STEST"
R n=GPR i=13 d=0x00000000

I ea=0x1c id=8
M n=Mem t=ifetch ea=0x1c ra=0x1c d=0x7c400124
INSTR op=0x7c400124					asm="mtmsr r2"
R n=MSR d=0x00000000

I ea=0x20 id=9
M n=Mem t=ifetch ea=0x20 ra=0x20 d=0x7dc31aa6
INSTR op=0x7dc31aa6					asm="mfspr r14,STEST"
R n=GPR i=14 d=0x00000001

I ea=0x24 id=10
M n=Mem t=ifetch ea=0x24 ra=0x24 d=0x00000000
INSTR op=0x00000000					asm="halt "

RESULTS

CORE n=:PMT:t0

RD n=GPR i=10 d=0x00000001
RD n=GPR i=11 d=0x00000000
RD n=GPR i=12 d=0x00000001
RD n=GPR i=13 d=0x00000000
RD n=GPR i=14 d=0x00000001
