#
# Tests the use of an alternate test-set when using the MMU.
#

= asm

lwz  r2,0x3000(0)
lwz  r3,0x2004(0)
lwepx r4,r0,r10
lwepx r5,r0,r11
.long 0x0

= /asm

= aopts
  -mregnames -me500mc
= /aopts

= mdopts

instr-offset: 0x10ff4

= /mdopts

#
# <GEN>
MD n=Mem ra=0x00010ff4 d=0x80403000	#	lwz  r2,0x3000(0)
MD n=Mem ra=0x00010ff8 d=0x80602004	#	lwz  r3,0x2004(0)
MD n=Mem ra=0x00010ffc d=0x7C80503E	#	lwepx r4,r0,r10
MD n=Mem ra=0x00011000 d=0x7CA0583E	#	lwepx r5,r0,r11
MD n=Mem ra=0x00011004 d=0x00000000	#	.long 0x0
# </GEN>

CORE n=:P

RD n=MSR  d=0x00000000
RD n=PID0 d=0x00000001
RD n=ELPC d=0x0000000a
RD n=NIA  d=0x00000ff4

RD n=GPR i=10 d=0x1000
RD n=GPR i=11 d=0x2004

MD n=Mem ra=0xa1000 d=0xdeadbeef
MD n=Mem ra=0xb2004 d=0x12345678
MD n=Mem ra=0xb7000 d=0x87654321
MD n=Mem ra=0xc2004 d=0xb0f0babe

# ea=0x0000 ra=0x10000
TD n=TlbCam set=0 way=0 V=1 TID=0x1 SIZE=1 TS=0 RPN=0x40 WIMG=0x1 SX=1 SR=1 SW=1 EPN=0

# ea=0x1000 ra=0x10000
TD n=TlbCam set=0 way=1 V=1 TID=0x1 SIZE=1 TS=0 RPN=0x44 WIMG=0x1 SX=1 SR=1 SW=1 EPN=4

# ea=0x3000 ra=0xA1000
TD n=TlbCam set=0 way=2 V=1 TID=0x1 SIZE=1 TS=0 RPN=0x284 WIMG=0x2 SX=1 SR=1 SW=1 EPN=0xc

# ea=0x2000 ra=0xB2000
TD n=TlbCam set=0 way=3 V=1 TID=0x1 SIZE=1 TS=0 RPN=0x2c8 WIMG=0x3 SX=1 SR=1 SW=1 EPN=0x8

# ea=0x1000 ra=0xB7000
TD n=TlbCam set=0 way=4 V=1 TID=0xa SIZE=1 TS=0 RPN=0x2dc WIMG=0x4 SX=1 SR=1 SW=1 EPN=0x4

# ea=0x2000 ra=0xC2000
TD n=TlbCam set=0 way=5 V=1 TID=0xa SIZE=1 TS=0 RPN=0x308 WIMG=0x3 SX=1 SR=1 SW=1 EPN=0x8

TRACE

I ea=0xff4 id=1
R n=HitReg d=0x00000001
T n=TlbCam t=instr  E=0x0 EPN=0x0 RPN=0x40 SIZE=0x1 SR=0x1 SW=0x1 SX=0x1 TID=0x1 TS=0x0 UR=0x0 UW=0x0 UX=0x0 V=0x1 WIMG=0x1
M n=Mem t=ifetch ea=0xff4 ra=0x10ff4 d=0x80403000
INSTR op=0x80403000					asm="lwz r2,12288(r0)"
R n=NIA d=0x00000ff8
D n=Mem t=read ea=0x3000 nb=4
R n=HitReg d=0x00000002
T n=TlbCam t=load  E=0x0 EPN=0xc RPN=0x284 SIZE=0x1 SR=0x1 SW=0x1 SX=0x1 TID=0x1 TS=0x0 UR=0x0 UW=0x0 UX=0x0 V=0x1 WIMG=0x2
M n=Mem t=read ea=0x3000 ra=0xa1000 d=0xdeadbeef
R n=GPR i=2 d=0xdeadbeef

I ea=0xff8 id=2
T n=TlbCam t=instr  E=0x0 EPN=0x0 RPN=0x40 SIZE=0x1 SR=0x1 SW=0x1 SX=0x1 TID=0x1 TS=0x0 UR=0x0 UW=0x0 UX=0x0 V=0x1 WIMG=0x1
M n=Mem t=ifetch ea=0xff8 ra=0x10ff8 d=0x80602004
INSTR op=0x80602004					asm="lwz r3,8196(r0)"
R n=NIA d=0x00000ffc
D n=Mem t=read ea=0x2004 nb=4
R n=HitReg d=0x00000003
T n=TlbCam t=load  E=0x0 EPN=0x8 RPN=0x2c8 SIZE=0x1 SR=0x1 SW=0x1 SX=0x1 TID=0x1 TS=0x0 UR=0x0 UW=0x0 UX=0x0 V=0x1 WIMG=0x3
M n=Mem t=read ea=0x2004 ra=0xb2004 d=0x12345678
R n=GPR i=3 d=0x12345678

I ea=0xffc id=3
T n=TlbCam t=instr  E=0x0 EPN=0x0 RPN=0x40 SIZE=0x1 SR=0x1 SW=0x1 SX=0x1 TID=0x1 TS=0x0 UR=0x0 UW=0x0 UX=0x0 V=0x1 WIMG=0x1
M n=Mem t=ifetch ea=0xffc ra=0x10ffc d=0x7c80503e
INSTR op=0x7c80503e					asm="lwepx r4,r0,r10"
R n=NIA d=0x00001000
D n=Mem t=read ea=0x1000 nb=4
R n=HitReg d=0x00000004
T n=TlbCam t=load  E=0x0 EPN=0x4 RPN=0x2dc SIZE=0x1 SR=0x1 SW=0x1 SX=0x1 TID=0xa TS=0x0 UR=0x0 UW=0x0 UX=0x0 V=0x1 WIMG=0x4
M n=Mem t=read ea=0x1000 ra=0xb7000 d=0x87654321
R n=GPR i=4 d=0x87654321

I ea=0x1000 id=4
R n=HitReg d=0x00000005
T n=TlbCam t=instr  E=0x0 EPN=0x4 RPN=0x44 SIZE=0x1 SR=0x1 SW=0x1 SX=0x1 TID=0x1 TS=0x0 UR=0x0 UW=0x0 UX=0x0 V=0x1 WIMG=0x1
M n=Mem t=ifetch ea=0x1000 ra=0x11000 d=0x7ca0583e
INSTR op=0x7ca0583e					asm="lwepx r5,r0,r11"
R n=NIA d=0x00001004
D n=Mem t=read ea=0x2004 nb=4
R n=HitReg d=0x00000006
T n=TlbCam t=load  E=0x0 EPN=0x8 RPN=0x308 SIZE=0x1 SR=0x1 SW=0x1 SX=0x1 TID=0xa TS=0x0 UR=0x0 UW=0x0 UX=0x0 V=0x1 WIMG=0x3
M n=Mem t=read ea=0x2004 ra=0xc2004 d=0xb0f0babe
R n=GPR i=5 d=0xb0f0babe

I ea=0x1004 id=5
T n=TlbCam t=instr  E=0x0 EPN=0x4 RPN=0x44 SIZE=0x1 SR=0x1 SW=0x1 SX=0x1 TID=0x1 TS=0x0 UR=0x0 UW=0x0 UX=0x0 V=0x1 WIMG=0x1
M n=Mem t=ifetch ea=0x1004 ra=0x11004 d=0x00000000
INSTR op=0x00000000					asm="halt "
R n=NIA d=0x00001008


RESULTS

RD n=GPR i=2 d=0xdeadbeef
RD n=GPR i=3 d=0x12345678
RD n=GPR i=4 d=0x87654321
RD n=GPR i=5 d=0xb0f0babe

MD n=Mem ra=0xa1000 d=0xdeadbeef
MD n=Mem ra=0xb2004 d=0x12345678
MD n=Mem ra=0xb7000 d=0x87654321
MD n=Mem ra=0xc2004 d=0xb0f0babe
