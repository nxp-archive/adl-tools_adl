#
# Tests a custom PLRU algorithm.
#

CORE n=:P

= asm

	lwz r1,0(r10)
	addi r10,r10,0x2000
	lwz r1,0(r10)
	addi r10,r10,0x2000
	lwz r1,0(r10)
	addi r10,r10,0x2000
	lwz r1,0(r10)
	addi r10,r10,0x2000
	lwz r1,0(r10)
	addi r10,r10,0x2000
	lwz r1,0(r10)
	addi r10,r10,0x2000
	lwz r1,0(r10)
	addi r10,r10,0x2000
	lwz r1,0(r10)         # Way is fully used at this point.
	lwz r1,0(r11)         # Will hit, but will adjust bits.
	lwz r1,0(r12)         # Will hit, but will adjust bits.
	addi r10,r10,0x2000
	lwz r1,0(r10)         # Will miss.

= /asm

= aopts

 -mregnames -me500

= /aopts

= mdopts

 instr-offset: 0x100

= /mdopts

# <GEN>
MD n=Mem ra=0x00000100 d=0x802A0000	#	lwz r1,0(r10)
MD n=Mem ra=0x00000104 d=0x394A2000	#	addi r10,r10,0x2000
MD n=Mem ra=0x00000108 d=0x802A0000	#	lwz r1,0(r10)
MD n=Mem ra=0x0000010c d=0x394A2000	#	addi r10,r10,0x2000
MD n=Mem ra=0x00000110 d=0x802A0000	#	lwz r1,0(r10)
MD n=Mem ra=0x00000114 d=0x394A2000	#	addi r10,r10,0x2000
MD n=Mem ra=0x00000118 d=0x802A0000	#	lwz r1,0(r10)
MD n=Mem ra=0x0000011c d=0x394A2000	#	addi r10,r10,0x2000
MD n=Mem ra=0x00000120 d=0x802A0000	#	lwz r1,0(r10)
MD n=Mem ra=0x00000124 d=0x394A2000	#	addi r10,r10,0x2000
MD n=Mem ra=0x00000128 d=0x802A0000	#	lwz r1,0(r10)
MD n=Mem ra=0x0000012c d=0x394A2000	#	addi r10,r10,0x2000
MD n=Mem ra=0x00000130 d=0x802A0000	#	lwz r1,0(r10)
MD n=Mem ra=0x00000134 d=0x394A2000	#	addi r10,r10,0x2000
MD n=Mem ra=0x00000138 d=0x802A0000	#	lwz r1,0(r10)         # Way is fully used at this point.
MD n=Mem ra=0x0000013c d=0x802B0000	#	lwz r1,0(r11)         # Will hit, but will adjust bits.
MD n=Mem ra=0x00000140 d=0x802C0000	#	lwz r1,0(r12)         # Will hit, but will adjust bits.
MD n=Mem ra=0x00000144 d=0x394A2000	#	addi r10,r10,0x2000
MD n=Mem ra=0x00000148 d=0x802A0000	#	lwz r1,0(r10)         # Will miss.
# </GEN>

RD n=NIA d=0x0100

RD n=GPR i=11 d=0x2000
RD n=GPR i=12 d=0x6000

MD n=Mem ra=0x00000 d=0x1
MD n=Mem ra=0x02000 d=0x2
MD n=Mem ra=0x04000 d=0x3
MD n=Mem ra=0x06000 d=0x4
MD n=Mem ra=0x08000 d=0x5
MD n=Mem ra=0x0a000 d=0x6
MD n=Mem ra=0x0c000 d=0x7
MD n=Mem ra=0x0e000 d=0x8
MD n=Mem ra=0x10000 d=0x9

TRACE

A l=1 m="Tracing ON."

I ea=0x100 id=1
C n=L1i a=miss t=ifetch set=2 way=0 lm=0x7f ra=0x100
C n=L1i a=load t=ifetch set=2 way=0 lm=0x7f ra=0x100
M n=Mem t=ifetch ea=0x100 ra=0x100 d=0x802a0000
INSTR op=0x802a0000 asm="lwz 1,10,0"
C n=L1d a=miss t=read set=0 way=0 lm=0x7f ra=0x0
C n=L1d a=load t=read set=0 way=0 lm=0x7f ra=0x0
A l=1 m="B:  0x68"
M n=Mem t=read ea=0x0 ra=0x0 d=0x00000001
R n=GPR i=1 d=0x00000001

I ea=0x104 id=2
C n=L1i a=hit t=ifetch set=2 way=0 lm=0x7f ra=0x100
M n=Mem t=ifetch ea=0x104 ra=0x104 d=0x394a2000
INSTR op=0x394a2000 asm="addi 10,10,8192"
R n=GPR i=10 d=0x00002000

I ea=0x108 id=3
C n=L1i a=hit t=ifetch set=2 way=0 lm=0x7f ra=0x100
M n=Mem t=ifetch ea=0x108 ra=0x108 d=0x802a0000
INSTR op=0x802a0000 asm="lwz 1,10,0"
C n=L1d a=miss t=read set=0 way=4 lm=0x7f ra=0x2000
C n=L1d a=load t=read set=0 way=4 lm=0x7f ra=0x2000
A l=1 m="B:  0x3a"
M n=Mem t=read ea=0x2000 ra=0x2000 d=0x00000002
R n=GPR i=1 d=0x00000002

I ea=0x10c id=4
C n=L1i a=hit t=ifetch set=2 way=0 lm=0x7f ra=0x100
M n=Mem t=ifetch ea=0x10c ra=0x10c d=0x394a2000
INSTR op=0x394a2000 asm="addi 10,10,8192"
R n=GPR i=10 d=0x00004000

I ea=0x110 id=5
C n=L1i a=hit t=ifetch set=2 way=0 lm=0x7f ra=0x100
M n=Mem t=ifetch ea=0x110 ra=0x110 d=0x802a0000
INSTR op=0x802a0000 asm="lwz 1,10,0"
C n=L1d a=miss t=read set=0 way=2 lm=0x7f ra=0x4000
C n=L1d a=load t=read set=0 way=2 lm=0x7f ra=0x4000
A l=1 m="B:  0x5e"
M n=Mem t=read ea=0x4000 ra=0x4000 d=0x00000003
R n=GPR i=1 d=0x00000003

I ea=0x114 id=6
C n=L1i a=hit t=ifetch set=2 way=0 lm=0x7f ra=0x100
M n=Mem t=ifetch ea=0x114 ra=0x114 d=0x394a2000
INSTR op=0x394a2000 asm="addi 10,10,8192"
R n=GPR i=10 d=0x00006000

I ea=0x118 id=7
C n=L1i a=hit t=ifetch set=2 way=0 lm=0x7f ra=0x100
M n=Mem t=ifetch ea=0x118 ra=0x118 d=0x802a0000
INSTR op=0x802a0000 asm="lwz 1,10,0"
C n=L1d a=miss t=read set=0 way=6 lm=0x7f ra=0x6000
C n=L1d a=load t=read set=0 way=6 lm=0x7f ra=0x6000
A l=1 m="B:  0x0f"
M n=Mem t=read ea=0x6000 ra=0x6000 d=0x00000004
R n=GPR i=1 d=0x00000004

I ea=0x11c id=8
C n=L1i a=hit t=ifetch set=2 way=0 lm=0x7f ra=0x100
M n=Mem t=ifetch ea=0x11c ra=0x11c d=0x394a2000
INSTR op=0x394a2000 asm="addi 10,10,8192"
R n=GPR i=10 d=0x00008000

I ea=0x120 id=9
C n=L1i a=hit t=ifetch set=2 way=0 lm=0x7f ra=0x100
M n=Mem t=ifetch ea=0x120 ra=0x120 d=0x802a0000
INSTR op=0x802a0000 asm="lwz 1,10,0"
C n=L1d a=miss t=read set=0 way=1 lm=0x7f ra=0x8000
C n=L1d a=load t=read set=0 way=1 lm=0x7f ra=0x8000
A l=1 m="B:  0x67"
M n=Mem t=read ea=0x8000 ra=0x8000 d=0x00000005
R n=GPR i=1 d=0x00000005

I ea=0x124 id=10
C n=L1i a=hit t=ifetch set=2 way=0 lm=0x7f ra=0x100
M n=Mem t=ifetch ea=0x124 ra=0x124 d=0x394a2000
INSTR op=0x394a2000 asm="addi 10,10,8192"
R n=GPR i=10 d=0x0000a000

I ea=0x128 id=11
C n=L1i a=hit t=ifetch set=2 way=0 lm=0x7f ra=0x100
M n=Mem t=ifetch ea=0x128 ra=0x128 d=0x802a0000
INSTR op=0x802a0000 asm="lwz 1,10,0"
C n=L1d a=miss t=read set=0 way=5 lm=0x7f ra=0xa000
C n=L1d a=load t=read set=0 way=5 lm=0x7f ra=0xa000
A l=1 m="B:  0x35"
M n=Mem t=read ea=0xa000 ra=0xa000 d=0x00000006
R n=GPR i=1 d=0x00000006

I ea=0x12c id=12
C n=L1i a=hit t=ifetch set=2 way=0 lm=0x7f ra=0x100
M n=Mem t=ifetch ea=0x12c ra=0x12c d=0x394a2000
INSTR op=0x394a2000 asm="addi 10,10,8192"
R n=GPR i=10 d=0x0000c000

I ea=0x130 id=13
C n=L1i a=hit t=ifetch set=2 way=0 lm=0x7f ra=0x100
M n=Mem t=ifetch ea=0x130 ra=0x130 d=0x802a0000
INSTR op=0x802a0000 asm="lwz 1,10,0"
C n=L1d a=miss t=read set=0 way=3 lm=0x7f ra=0xc000
C n=L1d a=load t=read set=0 way=3 lm=0x7f ra=0xc000
A l=1 m="B:  0x51"
M n=Mem t=read ea=0xc000 ra=0xc000 d=0x00000007
R n=GPR i=1 d=0x00000007

I ea=0x134 id=14
C n=L1i a=hit t=ifetch set=2 way=0 lm=0x7f ra=0x100
M n=Mem t=ifetch ea=0x134 ra=0x134 d=0x394a2000
INSTR op=0x394a2000 asm="addi 10,10,8192"
R n=GPR i=10 d=0x0000e000

I ea=0x138 id=15
C n=L1i a=hit t=ifetch set=2 way=0 lm=0x7f ra=0x100
M n=Mem t=ifetch ea=0x138 ra=0x138 d=0x802a0000
INSTR op=0x802a0000 asm="lwz 1,10,0"
C n=L1d a=miss t=read set=0 way=7 lm=0x7f ra=0xe000
C n=L1d a=load t=read set=0 way=7 lm=0x7f ra=0xe000
A l=1 m="B:  0x00"
M n=Mem t=read ea=0xe000 ra=0xe000 d=0x00000008
R n=GPR i=1 d=0x00000008

I ea=0x13c id=16
C n=L1i a=hit t=ifetch set=2 way=0 lm=0x7f ra=0x100
M n=Mem t=ifetch ea=0x13c ra=0x13c d=0x802b0000
INSTR op=0x802b0000 asm="lwz 1,11,0"
C n=L1d a=hit t=read set=0 way=4 lm=0x7f ra=0x2000
A l=1 m="B:  0x12"
M n=Mem t=read ea=0x2000 ra=0x2000 d=0x00000002
R n=GPR i=1 d=0x00000002

I ea=0x140 id=17
C n=L1i a=hit t=ifetch set=2 way=0 lm=0x7f ra=0x100
M n=Mem t=ifetch ea=0x140 ra=0x140 d=0x802c0000
INSTR op=0x802c0000 asm="lwz 1,12,0"
C n=L1d a=hit t=read set=0 way=6 lm=0x7f ra=0x6000
A l=1 m="B:  0x03"
M n=Mem t=read ea=0x6000 ra=0x6000 d=0x00000004
R n=GPR i=1 d=0x00000004

I ea=0x144 id=18
C n=L1i a=hit t=ifetch set=2 way=0 lm=0x7f ra=0x100
M n=Mem t=ifetch ea=0x144 ra=0x144 d=0x394a2000
INSTR op=0x394a2000 asm="addi 10,10,8192"
R n=GPR i=10 d=0x00010000

I ea=0x148 id=19
C n=L1i a=hit t=ifetch set=2 way=0 lm=0x7f ra=0x100
M n=Mem t=ifetch ea=0x148 ra=0x148 d=0x802a0000
INSTR op=0x802a0000 asm="lwz 1,10,0"
C n=L1d a=miss t=read set=0 way=0 lm=0x7f ra=0x10000
C n=L1d a=load t=read set=0 way=0 lm=0x7f ra=0x10000
A l=1 m="B:  0x6b"
M n=Mem t=read ea=0x10000 ra=0x10000 d=0x00000009
R n=GPR i=1 d=0x00000009

I ea=0x14c id=20
C n=L1i a=hit t=ifetch set=2 way=0 lm=0x7f ra=0x100
M n=Mem t=ifetch ea=0x14c ra=0x14c d=0x0
INSTR op=0x0 asm="halt"

A l=1 m="Tracing OFF."
A l=1 m="Dummy helper called."

RESULTS

CD n=L1d set=0 way=0 ra=0x0000000000010000 valid=1 dirty=0 locked=0 B=0x6b d=0x00000009,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000
CD n=L1d set=0 way=1 ra=0x0000000000008000 valid=1 dirty=0 locked=0 B=0x6b d=0x00000005,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000
CD n=L1d set=0 way=2 ra=0x0000000000004000 valid=1 dirty=0 locked=0 B=0x6b d=0x00000003,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000
CD n=L1d set=0 way=3 ra=0x000000000000c000 valid=1 dirty=0 locked=0 B=0x6b d=0x00000007,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000
CD n=L1d set=0 way=4 ra=0x0000000000002000 valid=1 dirty=0 locked=0 B=0x6b d=0x00000002,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000
CD n=L1d set=0 way=5 ra=0x000000000000a000 valid=1 dirty=0 locked=0 B=0x6b d=0x00000006,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000
CD n=L1d set=0 way=6 ra=0x0000000000006000 valid=1 dirty=0 locked=0 B=0x6b d=0x00000004,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000
CD n=L1d set=0 way=7 ra=0x000000000000e000 valid=1 dirty=0 locked=0 B=0x6b d=0x00000008,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000
CD n=L1i set=2 way=0 ra=0x0000000000000100 valid=1 dirty=0 locked=0 d=0x802a0000,0x394a2000,0x802a0000,0x394a2000,0x802a0000,0x394a2000,0x802a0000,0x394a2000,0x802a0000,0x394a2000,0x802a0000,0x394a2000,0x802a0000,0x394a2000,0x802a0000,0x802b0000,0x802c0000,0x394a2000,0x802a0000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000

MD n=Mem ra=0x0000000000000000 d=0x00000001	#	(1)
MD n=Mem ra=0x0000000000002000 d=0x00000002	#	(2)
MD n=Mem ra=0x0000000000004000 d=0x00000003	#	(3)
MD n=Mem ra=0x0000000000006000 d=0x00000004	#	(4)
MD n=Mem ra=0x0000000000008000 d=0x00000005	#	(5)
MD n=Mem ra=0x000000000000a000 d=0x00000006	#	(6)
MD n=Mem ra=0x000000000000c000 d=0x00000007	#	(7)
MD n=Mem ra=0x000000000000e000 d=0x00000008	#	(8)
MD n=Mem ra=0x0000000000010000 d=0x00000009	#	(9)
